<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Brackets</title>

  <link rel="stylesheet" href="css/theme.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>

<div class="container">

  <h1>Brackets</h1>
  <p class="muted">Competitive brackets. Real stakes.</p>

  <!-- AUTH CARD -->
  <div class="card" id="authCard">
    <h2 id="authTitle">Sign In</h2>

    <input id="email" type="email" placeholder="Email" style="width:100%; padding:12px; margin-bottom:12px;">
    <input id="password" type="password" placeholder="Password" style="width:100%; padding:12px; margin-bottom:16px;">

    <button id="authBtn" style="width:100%;">Sign In</button>

    <p style="text-align:center; margin-top:14px;">
      <span id="toggleText">Don't have an account?</span>
      <a href="#" id="toggleAuth">Sign up</a>
    </p>
  </div>

  <!-- MAIN NAV (HIDDEN UNTIL LOGGED IN) -->
  <div id="mainNav" class="grid" style="display:none; margin-top:30px;">
    <a href="join.html"><button>Join a Comp</button></a>
    <a href="my-comps.html"><button>My Comps</button></a>
    <a href="profile.html"><button>Profile</button></a>
    <a href="store.html"><button>Store</button></a>
  </div>

</div>

<script type="module">
import { auth } from "./js/firebase.js";
import {
  signInWithEmailAndPassword,
  createUserWithEmailAndPassword,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const authBtn = document.getElementById("authBtn");
const toggleAuth = document.getElementById("toggleAuth");
const authTitle = document.getElementById("authTitle");
const toggleText = document.getElementById("toggleText");

let isSignIn = true;

toggleAuth.onclick = (e) => {
  e.preventDefault();
  isSignIn = !isSignIn;

  authTitle.textContent = isSignIn ? "Sign In" : "Sign Up";
  authBtn.textContent = isSignIn ? "Sign In" : "Create Account";
  toggleText.textContent = isSignIn
    ? "Don't have an account?"
    : "Already have an account?";
  toggleAuth.textContent = isSignIn ? "Sign up" : "Sign in";
};

authBtn.onclick = async () => {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  try {
    if (isSignIn) {
      await signInWithEmailAndPassword(auth, email, password);
    } else {
      await createUserWithEmailAndPassword(auth, email, password);
    }
  } catch (err) {
    alert(err.message);
  }
};

onAuthStateChanged(auth, user => {
  if (user) {
    document.getElementById("authCard").style.display = "none";
    document.getElementById("mainNav").style.display = "grid";
  }
});
</script>

</body>
</html>
